# didn’t have link to the original script link & author; this dumps ECC certificate authorities
# author says Defender detects exploits for self signed CA’s but didn’t identify source file or process
function Export-CertificateB64 ($Certificate)
{
  $TmpFile = New-TemporaryFile
  $OutName = $Certificate.Thumbprint + ".cer"
  Export-Certificate -Cert $Certificate -FilePath $TmpFile.FullName | Out-Null
  Start-Process -FilePath 'certutil.exe' -ArgumentList "-encode $TmpFile $OutName" -WindowStyle Hidden
  Write-Host "Exported Base64 encoded certificate to" $OutName "for" $Certificate.DnsNameList.Unicode
}
$ECC_Local_Certs = Get-ChildItem Cert:\LocalMachine\Root | Where-Object {$_.PublicKey.EncodedParameters.RawData[0] -EQ 0x06}
$ECC_Local_Certs | ForEach-Object  { Export-CertificateB64  -Certificate $_ }
# $ECC_User_Certs = Get-ChildItem Cert:\CurrentUser\Root | Where-Object {$_.PublicKey.EncodedParameters.RawData[0] -EQ 0x06}
# $ECC_User_Certs | ForEach-Object  { Export-CertificateB64  -Certificate $_ }
